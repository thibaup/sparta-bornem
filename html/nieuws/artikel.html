<!DOCTYPE html>
<html lang="nl-NL">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title will be set dynamically by JS -->
    <title>Nieuwsartikel - Sparta Bornem</title>
    <link rel="icon" type="image/png" href="/images/website-logo.png"> <!-- Assuming favicon in root -->
    <link rel="stylesheet" href="/css/style.css"> <!-- Link main CSS -->

    <!-- Specific Styles for Single Article Page -->
    <style>
        /* --- Basic Reset & Body Styling --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; background-color: #f4f4f4; }
        /* Ensure container respects max-width and has horizontal padding */
        .container { max-width: 1140px; margin: 20px auto; padding: 0 20px; } /* Added top/bottom margin */
        a { color: #1774b4; text-decoration: none; }
        a:hover { text-decoration: underline; }
        img { max-width: 100%; height: auto; display: block; /* Prevent potential bottom space */ }
        h1, h2, h3, h4 { margin-bottom: 0.8em; color: #1a1a1a; font-weight: 600; }
        p { margin-bottom: 1em; }
        ul { margin-bottom: 1em; margin-left: 20px; }
        mark { background-color: #ffe066; padding: 0.1em 0.3em; border-radius: 3px; }
        strong, b { font-weight: 600; }

        /* --- Main Content Area Wrapper --- */
        .main-content {
            /* This container already has max-width and padding from .container */
            padding-top: 20px;    /* Add space below header */
            padding-bottom: 40px; /* Add space above footer */
        }

        /* --- Single Article Styling --- */
        .article-container {
            background-color: #ffffff;
            /* Increased padding for more whitespace */
            padding: 30px 40px 40px 40px; /* Added bottom padding */
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08); /* Slightly deeper shadow */
            margin-bottom: 40px; /* Space below article box before back link */
        }

        #article-title {
            color: #1774b4;
            margin-top: 0;
            margin-bottom: 10px; /* Space below title */
            font-size: clamp(1.8em, 4vw, 2.5em); /* Responsive title size */
            line-height: 1.3;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px; /* More space below border */
        }

        .article-meta {
            display: block;
            color: #6c757d;
            font-size: 0.9em;
            margin-bottom: 25px; /* Space below meta */
        }

        /* Style image container, not just image, if needed */
        #article-image-container {
            text-align: center; /* Center the image within this div */
            margin-bottom: 30px; /* Space below image */
        }

        .article-image {
            /* Max width to prevent huge images, but allow smaller ones */
            max-width: 100%;
            width: auto; /* Let image scale naturally up to max-width */
            max-height: 500px; /* Optional: Prevent overly tall images */
            height: auto;
            border-radius: 5px;
            display: inline-block; /* Allows centering via text-align on parent */
        }

        .article-full-content {
            line-height: 1.7;
            font-size: 1.05em; /* Slightly larger body text */
            /* --- FIX FOR TEXT OVERFLOW --- */
            overflow-wrap: break-word; /* Standard property */
            word-wrap: break-word;     /* Older browsers fallback */
            word-break: break-word;    /* Helps break long words/URLs */
            /* Ensure child elements don't cause overflow if they have fixed widths */
            overflow: hidden; /* Added: Hide potential overflow from child elements */
        }

        .article-full-content p {
            margin-bottom: 1.2em;
        }
        .article-full-content a {
            font-weight: 500;
            /* Ensure links also break if very long */
            overflow-wrap: break-word;
            word-wrap: break-word;
            word-break: break-word;
            /* Maybe slightly different color? */
            /* color: #125a8c; */
        }
        .article-full-content a:hover {
            text-decoration: none;
        }
        /* Add styles for other potential elements if needed */
        .article-full-content ul,
        .article-full-content ol {
            margin-left: 25px;
            margin-bottom: 1.2em;
        }
        .article-full-content li {
            margin-bottom: 0.5em;
        }
        .article-full-content blockquote {
            border-left: 4px solid #eee;
            padding-left: 15px;
            margin: 1.5em 0;
            color: #666;
            font-style: italic;
        }
        .article-full-content code { /* Basic styling for code */
            background-color: #f1f1f1;
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-family: monospace;
            font-size: 0.9em;
            /* Code can overflow easily */
            white-space: pre-wrap; /* Wrap code but preserve whitespace */
            word-break: break-all; /* Allow breaking anywhere in code */
        }
        .article-full-content pre { /* Styling for preformatted blocks */
            background-color: #f1f1f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto; /* Add scrollbar if code block is too wide */
            margin: 1.5em 0;
        }
        .article-full-content pre code {
            background-color: transparent; /* Reset code style inside pre */
            padding: 0;
            white-space: pre; /* Preserve whitespace exactly as is */
            word-break: normal; /* Don't break words inside pre */
        }


        /* Loading/Error messages */
        #article-loading, #article-error {
            text-align: center; padding: 40px 20px; font-style: italic; font-size: 1.1em; color: #6c757d;
        }
        #article-error { color: #dc3545; font-weight: 500; }

        /* Back link styling */
        .back-link {
            display: inline-block;
            /* No top margin needed here, use margin on .article-container */
            font-weight: 600;
            color: #1774b4;
            text-decoration: none;
            padding: 8px 15px;
            border: 1px solid #1774b4;
            border-radius: 4px;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        .back-link:hover {
            background-color: #1774b4;
            color: #fff;
            text-decoration: none;
        }
    </style>
</head>
<body>

    <!-- Use main tag with container and main-content classes -->
    <main class="container main-content">

        <div class="article-container">
            <article>
                <h1 id="article-title">Artikel Laden...</h1>
                <span id="article-meta" class="article-meta"></span>
                <div id="article-image-container"></div>
                <div id="article-body" class="article-full-content">
                    <p id="article-loading">Artikel laden...</p>
                    <p id="article-error" style="display: none;">Artikel kon niet worden geladen of gevonden.</p>
                </div>
            </article>
        </div> <!-- End article-container -->

        <a href="/html/nieuws/nieuws.html" class="back-link" id="back-link">« Terug naar Nieuwsoverzicht</a>

    </main>
    <script>
        async function loadSingleArticle() {
            const params = new URLSearchParams(window.location.search);
            const articleId = params.get('id'); 
            const referrerUrl = params.get('ref'); 

            const titleEl = document.getElementById('article-title');
            const metaEl = document.getElementById('article-meta');
            const imageContainer = document.getElementById('article-image-container');
            const bodyEl = document.getElementById('article-body');
            const loadingEl = document.getElementById('article-loading');
            const errorEl = document.getElementById('article-error');
            const backLink = document.getElementById('back-link');

            titleEl.textContent = "Artikel Laden...";
            if (loadingEl) loadingEl.style.display = 'block';
            if (errorEl) errorEl.style.display = 'none';
            bodyEl.innerHTML = ''; 
            imageContainer.innerHTML = '';
            metaEl.textContent = '';

            const defaultBackHref = '/html/nieuws/nieuws.html';
            const defaultBackText = '« Terug naar Nieuwsoverzicht';
            if (backLink) {
                if (referrerUrl) {
                    try {
                        const decodedRef = decodeURIComponent(referrerUrl);
                        backLink.href = decodedRef;
                        if (decodedRef.includes('nieuws.html') || decodedRef.includes('%2Fhtml%2Fnieuws%2Fnieuws')) {
                            backLink.textContent = '« Terug naar Nieuwsoverzicht';
                        } else if (decodedRef === '/' || decodedRef.includes('home.html') || decodedRef.includes('index.html')) {
                            backLink.textContent = '« Terug naar Home';
                        } else {
                            backLink.textContent = '« Terug naar Vorige';
                        }
                    } catch (e) {
                        console.error("Error decoding referrer URL:", e);
                        backLink.href = defaultBackHref
                        backLink.textContent = defaultBackText;
                    }
                } else {
                    backLink.href = defaultBackHref;
                    backLink.textContent = defaultBackText;
                }
                backLink.style.display = 'inline-block'; 
            }

            if (!articleId) {
                titleEl.textContent = "Fout";
                if (loadingEl) loadingEl.style.display = 'none';
                errorEl.textContent = "Geen artikel ID gevonden in de URL.";
                errorEl.style.display = 'block';
                if (backLink) backLink.style.display = 'inline-block'; 
                return;
            }
            const newsDataUrl = '/html/nieuws/nieuws-data.json'; 

            try {
                const response = await fetch(newsDataUrl);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status} fetching ${newsDataUrl}`);
                }
                const allNewsData = await response.json();

                const articleData = allNewsData.find(item => item.id === articleId);

                if (!articleData) {
                    throw new Error(`Artikel met ID '${articleId}' niet gevonden in JSON data.`);
                }

                document.title = `${articleData.title} - Sparta Bornem`;
                titleEl.textContent = articleData.title;

                const itemDate = new Date(articleData.date);
                metaEl.textContent = `${itemDate.toLocaleDateString('nl-BE', { day: 'numeric', month: 'long', year: 'numeric' })} | ${articleData.category || 'Algemeen'}`;


                if (articleData.image) {
                    let finalImageUrl = articleData.image;
                     if (!finalImageUrl.startsWith('http://') && !finalImageUrl.startsWith('https://')) {
                         finalImageUrl = `/images/nieuws/${finalImageUrl.replace(/^\//, '')}`;
                     }
                    imageContainer.innerHTML = `<img class="article-image" src="${finalImageUrl}" alt="${articleData.alt || articleData.title}" loading="lazy">`;
                } else {
                    imageContainer.innerHTML = '';
                }

                if (articleData.full_content) {
                    const paragraphs = articleData.full_content.split('\\n')
                                        .map(p => p.trim()) 
                                        .filter(p => p.length > 0);
                    bodyEl.innerHTML = paragraphs.map(p => `<p>${p}</p>`).join('');
                } 

                if (loadingEl) loadingEl.style.display = 'none';

            } catch (error) {
                console.error(`Error loading article ${articleId}:`, error);
                titleEl.textContent = "Fout bij Laden";
                bodyEl.innerHTML = '';
                imageContainer.innerHTML = ''; // Clear image
                metaEl.textContent = ''; // Clear meta
                if (loadingEl) loadingEl.style.display = 'none';
                errorEl.textContent = `Fout: ${error.message}`;
                errorEl.style.display = 'block';

                if (backLink) backLink.style.display = 'inline-block';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadSingleArticle();
        });
    </script>
</body>
</html>